{
  "name": "order_placement_saga",
  "version": 1,
  "tasks": [
    {
      "name": "reserve_order",
      "taskReferenceName": "t_order",
      "type": "SIMPLE",
      "inputParameters": {
        "userId": "${workflow.input.userId}",
        "error": "${workflow.input.error}",
        "step": "${workflow.input.step}"
      }
    },
    {
      "name": "debit_payment",
      "taskReferenceName": "t_payment",
      "type": "SIMPLE",
      "inputParameters": {
        "userId": "${workflow.input.userId}",
        "amount": "${workflow.input.amount}",
        "orderId": "${t_order.output.orderId}",
        "error": "${workflow.input.error}",
        "step": "${workflow.input.step}"
      }
    },
    {
      "name": "reserve_inventory",
      "taskReferenceName": "t_inventory",
      "type": "SIMPLE",
      "inputParameters": {
        "userId": "${workflow.input.userId}",
        "orderId": "${t_order.output.orderId}",
        "items": "${workflow.input.items}",
        "error": "${workflow.input.error}",
        "step": "${workflow.input.step}"
      }
    },
    {
      "name": "create_shipping",
      "taskReferenceName": "t_shipping",
      "type": "SIMPLE",
      "inputParameters": {
        "userId": "${workflow.input.userId}",
        "orderId": "${t_order.output.orderId}",
        "address": "${workflow.input.address}",
        "error": "${workflow.input.error}",
        "step": "${workflow.input.step}"
      }
    },
    {
      "name": "complete_saga_task",
      "taskReferenceName": "complete_saga",
      "type": "SIMPLE",
      "inputParameters": {
        "orderId": "${t_order.output.orderId}",
        "paymentId": "${t_payment.output.paymentId}",
        "inventoryId": "${t_inventory.output.inventoryId}",
        "shipmentId": "${t_shipping.output.shipmentId}"
      }
    }
  ],
  "failureWorkflow": "order_saga_compensation",
  "schemaVersion": 2,
  "outputParameters": {
    "orderId": "${t_order.output.orderId}",
    "paymentId": "${t_payment.output.paymentId}",
    "inventoryId": "${t_inventory.output.inventoryId}",
    "shipmentId": "${t_shipping.output.shipmentId}"
  }
}
